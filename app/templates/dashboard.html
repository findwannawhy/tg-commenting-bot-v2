<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Панель управления</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<style>
		:root{
			--bg:#0b0c10; --panel:#111318; --muted:#8b95a7; --text:#e7eaf0; --accent:#5b9cff;
			--border:#1d2230; --good:#42b883; --warn:#f0ad4e; --bad:#ff6b6b;
		}
		*{ box-sizing: border-box; }
		body{ margin:0; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
		.container{ max-width: 1000px; margin: 0 auto; padding: 24px; }
		.nav{ display:flex; gap:10px; align-items:center; margin-bottom: 18px; }
		.nav a{ color:var(--muted); text-decoration:none; padding:8px 10px; border-radius:8px; }
		.nav a:hover{ background:var(--panel); color:var(--text); }
		h1{ font-size:22px; margin: 8px 0 16px; }
		.actions{ display:flex; flex-wrap:wrap; gap:10px; margin-bottom:16px; }
		button{ background:var(--panel); color:var(--text); border:1px solid var(--border); border-radius:10px; padding:8px 12px; cursor:pointer; }
		button:hover{ border-color:var(--accent); }
		.card{ background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:14px; }
		pre{ margin:0; font-size:13px; line-height:1.45; background:transparent; color:var(--muted); max-height:60vh; overflow:auto; }
		.footer{ color:var(--muted); margin-top:16px; font-size:12px; }
	</style>
</head>
<body>
	<div class="container">
		<div class="nav">
			<a href="/">Панель</a>
			<a href="/channels">Каналы</a>
			<a href="/settings">Настройки</a>
			<a href="/logs">Логи</a>
			<a href="/auth">Авторизация</a>
		</div>
		<h1>Telegram Commenter v2</h1>
		<div class="actions">
			<form method="post" action="/controls/start"><button>Старт</button></form>
			<form method="post" action="/controls/stop"><button>Стоп</button></form>
			<form method="post" action="/controls/restart"><button>Перезапуск</button></form>
			<form method="post" action="/metrics/reset"><button>Обнулить метрики</button></form>
		</div>
		<div class="card">
			<div style="display:flex; justify-content:space-between; align-items:center;">
				<h2 style="margin:0 0 10px; font-size:16px; color:var(--muted)">Метрики</h2>
				<button id="refresh-metrics" style="padding: 4px 8px; font-size: 12px; background: transparent; border: none;">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16" style="vertical-align: middle;">
						<path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
						<path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
					</svg>
				</button>
			</div>
			<pre id="metrics">Загрузка…</pre>
		</div>
		<div class="footer">Используйте навигацию для управления каналами, настройками и просмотра логов.</div>
	</div>
	<script>
	// This script is no longer needed with cookie-based auth.
	// We can add back the metrics loading part if needed, but without the complex auth logic.
	async function loadMetrics() {
		const r = await fetch('/metrics');
		if (r.ok) {
			document.getElementById('metrics').textContent = JSON.stringify(await r.json(), null, 2);
		} else if (r.status === 401) {
			window.location.href = '/enter-token';
		}
	}
	document.addEventListener('DOMContentLoaded', () => {
		loadMetrics();
		document.getElementById('refresh-metrics').addEventListener('click', loadMetrics);
	});
	</script>
</body>
</html>
